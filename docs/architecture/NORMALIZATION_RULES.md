# üß† NORMALIZATION_RULES ‚Äî MVP (Dictionary-driven + Manual Review)

## 0) –¶–µ–ª—å

–°—Ç–∞–±–∏–ª—å–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (`supplier_items`) —Å –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–º–∏ SKU (`normalized_skus`), —á—Ç–æ–±—ã:
- –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ñ—Ñ–µ—Ä—ã (`offers`) —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ confirmed mapping,
- –±—ã—Å—Ç—Ä–æ —á–∏–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å (–±–µ–∑ –ø—Ä–∞–≤–æ–∫ raw),
- –∏–º–µ—Ç—å —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π —Ä—É—á–Ω–æ–π —Ä–∞–∑–±–æ—Ä (–æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á).

---

## 1) –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è MVP

1) **SKU ‚â† Offer**
- SKU ‚Äî ‚Äú—á—Ç–æ —ç—Ç–æ –∑–∞ —Ç–æ–≤–∞—Ä‚Äù (—Ç–∏–ø + —Å–æ—Ä—Ç/–ª–∏–Ω–µ–π–∫–∞ + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ü–≤–µ—Ç/–ø–æ–¥—Ç–∏–ø).
- Offer ‚Äî ‚Äú–∫–∞–∫ –ø—Ä–æ–¥–∞—ë—Ç—Å—è‚Äù (–¥–ª–∏–Ω–∞, —É–ø–∞–∫–æ–≤–∫–∞, –∫—Ä–∞—Ç–Ω–æ—Å—Ç—å, —Ü–µ–Ω–∞, —Ç–∏—Ä—ã).

2) **–î–ª–∏–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Offer**, –∞ –Ω–µ –≤ SKU.  
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –µ—Å–ª–∏ —Ä—ã–Ω–æ–∫ —É –∑–∞–∫–∞–∑—á–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç SKU ‚Äú–†–æ–∑–∞ 60—Å–º Explorer‚Äù –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É ‚Äî —Ç–æ–≥–¥–∞ –≤–∫–ª—é—á–∞–µ–º length –≤ SKU (–Ω–æ —ç—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–∞—Ç–∞–ª–æ–≥).

3) –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **—Å–ª–æ–≤–∞—Ä—ë–º (dictionary_entries)** + —Ä—É—á–Ω—ã–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º.

---

## 2) –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å SKU (—á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º)

### 2.1 –ü–æ–ª—è normalized_sku (MVP)
- `product_type` (–æ–±—è–∑.) ‚Äî rose / carnation / alstroemeria / chrysanthemum / greens / packaging / etc.
- `variety` (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ) ‚Äî —Å–æ—Ä—Ç/–ª–∏–Ω–µ–π–∫–∞ (Explorer, Mondial, Pink Floyd‚Ä¶)
- `color` (–æ–ø—Ü.) ‚Äî –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –¥–∞–Ω–Ω—ã—Ö
- `title` ‚Äî —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `meta` (json) ‚Äî –¥–æ–ø. –∞—Ç—Ä–∏–±—É—Ç—ã:
  - `subtype`: spray / bush / standard / premium / etc
  - `origin_default`: Ecuador / Colombia / Netherlands / Kenya / Israel (–µ—Å–ª–∏ –¥–ª—è SKU –≤–∞–∂–Ω–æ)
  - `brand_farm`: PIANGOFLOR / FRAMA FLOWERS (–µ—Å–ª–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å)

> –í MVP: —Å—Ç—Ä–∞–Ω–∞/—Ñ–µ—Ä–º–∞ —á–∞—â–µ –∏–¥—É—Ç –∫–∞–∫ –∞—Ç—Ä–∏–±—É—Ç Offer/Source, –∞ –Ω–µ SKU.  
–ù–æ –¥–æ–ø—É—Å–∫–∞–µ–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ meta, –µ—Å–ª–∏ –∑–∞–∫–∞–∑—á–∏–∫ —Ç—Ä–µ–±—É–µ—Ç ‚Äú—Ä–∞–∑–Ω—ã–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏‚Äù –Ω–µ —Å–º–µ—à–∏–≤–∞—Ç—å.

---

## 3) Dictionary (dictionary_entries): —Ç–∏–ø—ã, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

`dictionary_entries` —Ö—Ä–∞–Ω–∏—Ç ‚Äú—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –∑–Ω–∞–Ω–∏—è‚Äù –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

### 3.1 –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å–∏
- `dict_type`: —Å—Ç—Ä–æ–∫–∞ (—Ç–∏–ø —Å–ª–æ–≤–∞—Ä—è)
- `key`: –∫–ª—é—á
- `value`: –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- `synonyms`: –º–∞—Å—Å–∏–≤ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
- `rules`: json —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ (regex/replace/extract)
- `status`: active/deprecated

### 3.2 –ù–∞–±–æ—Ä dict_type –¥–ª—è MVP
1) `product_type`
- key: "—Ä–æ–∑–∞"
- value: "rose"
- synonyms: ["rose", "—Ä–æ–∑—ã", "roses", "—Ä–æ–∑–∞ —Å–ø—Ä–µ–π", "–∫—É—Å—Ç–æ–≤–∞—è —Ä–æ–∑–∞", "—Å–ø—Ä–µ–π"]

2) `country`
- key: "—ç–∫–≤–∞–¥–æ—Ä"
- value: "Ecuador"
- synonyms: ["ecuador", "(—ç–∫–≤–∞–¥–æ—Ä)", "—ç–∫–≤."]

3) `pack_type`
- key: "–±–∞–∫"
- value: "bak"
- synonyms: ["–±–∞–∫.", "bucket", "–≤–µ–¥—Ä–æ"]
- key: "—É–ø–∞–∫"
- value: "pack"
- synonyms: ["—É–ø–∞–∫.", "—É–ø–∞–∫–æ–≤–∫–∞", "bunch", "box"]

4) `stopwords`
- key/value: –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ (—É–¥–∞–ª—è–µ–º—ã–µ —Ç–æ–∫–µ–Ω—ã)
- –ø—Ä–∏–º–µ—Ä—ã: ["–∏–º–ø–æ—Ä—Ç", "—Å–æ—Ä—Ç–æ–≤—ã–µ", "–ø–æ—Å—Ç–∞–≤–∫–∞", "—Ü–µ–Ω–∞", "—Ä—É–±", "—Ä", "—Å–º", "cm"]

5) `regex_rule`
- –ø—Ä–∞–≤–∏–ª–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (—Å–º. –±–ª–æ–∫ 4)

6) `variety_alias`
- –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–æ—Ä—Ç–æ–≤: key=–ª—é–±–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è ‚Üí value=–∫–∞–Ω–æ–Ω
- –ø—Ä–∏–º–µ—Ä: key="mondial" value="Mondial" synonyms=["–º–æ–Ω–¥–∏–∞–ª—å","mondial¬Æ"]

> –ù–∞ —Å—Ç–∞—Ä—Ç–µ `variety_alias` –º–æ–∂–Ω–æ –Ω–∞–ø–æ–ª–Ω—è—Ç—å –ø–æ –º–µ—Ä–µ —Ä—É—á–Ω–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ —Ç–æ–ø-100 —Å–æ—Ä—Ç–æ–≤.

---

## 4) –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (parsing rules)

**–í–∞–∂–Ω–æ:** —á–∞—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (length, pack_type) –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ —É–∂–µ –≤ `offer_candidates` –∏–∑ –º–∞—Ç—Ä–∏—Ü/—Ç–∏—Ä–æ–≤.  
–¢–æ–≥–¥–∞ –∏–∑ `raw_name` –∏—Ö –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ ‚Äúsource of truth‚Äù.

### 4.1 –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (preprocess)
–ü–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏:
- lower()
- trim
- –∑–∞–º–µ–Ω–∏—Ç—å "‚Äì" –∏ "‚Äî" –Ω–∞ "-"
- –∑–∞–º–µ–Ω–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –æ–¥–∏–Ω
- —É–±—Ä–∞—Ç—å —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (—Ç–∞–±/–ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫)
- —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å "—Å–º" / "cm"
- —É–¥–∞–ª–∏—Ç—å –≤–∞–ª—é—Ç—É: "—Ä—É–±", "—Ä", "‚ÇΩ" (–µ—Å–ª–∏ –ø–æ–ø–∞–ª–æ –≤ name)

### 4.2 Regex: –¥–ª–∏–Ω–∞ (length_cm)
–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ length_cm –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω –≤ offer_candidate:

- `(?<!\d)(\d{2,3})\s*(—Å–º|cm)\b`
- `\b(\d{2,3})\s*—Å–º\b`
- `\b(\d{2,3})\b(?=\s*—Å–º)` (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)

–ü–æ—Å—Ç-–≤–∞–ª–∏–¥–∞—Ü–∏—è:
- –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–ª–∏–Ω—ã: 30‚Äì120 (–∏–Ω–∞—á–µ warn)

### 4.3 Regex: —Å—Ç—Ä–∞–Ω–∞ (origin_country)
- `\((—ç–∫–≤–∞–¥–æ—Ä|–∫–æ–ª—É–º–±–∏—è|–≥–æ–ª–ª–∞–Ω–¥–∏—è|–Ω–∏–¥–µ—Ä–ª–∞–Ω–¥—ã|–∫–µ–Ω–∏—è|–∏–∑—Ä–∞–∏–ª—å)\)`
- `\b(—ç–∫–≤–∞–¥–æ—Ä|–∫–æ–ª—É–º–±–∏—è|–≥–æ–ª–ª–∞–Ω–¥–∏—è|–Ω–∏–¥–µ—Ä–ª–∞–Ω–¥—ã|–∫–µ–Ω–∏—è|–∏–∑—Ä–∞–∏–ª—å)\b`
–ú–∞–ø–ø–∏–º —á–µ—Ä–µ–∑ dict_type=country.

### 4.4 Regex: —É–ø–∞–∫–æ–≤–∫–∞ (pack_qty / pack_type)
- pack_qty:
  - `\((\d{1,3})\)\s*$`  (–≤ –∫–æ–Ω—Ü–µ)
  - `\((\d{1,3})\s*—à—Ç\)`  
  - `\b(\d{1,3})\s*—à—Ç\b` (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ: –º–æ–∂–µ—Ç –±—ã—Ç—å ‚Äú100 —à—Ç‚Äù –∫–∞–∫ tier ‚Äî –Ω–µ –ø—É—Ç–∞—Ç—å)
- pack_type:
  - `\b(–±–∞–∫|—É–ø–∞–∫)\b` –∏–ª–∏ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã

–ü–æ—Å—Ç-–ª–æ–≥–∏–∫–∞:
- –µ—Å–ª–∏ `pack_qty` –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 5‚Äì50 ‚Üí —Ç—Ä–∞–∫—Ç—É–µ–º –∫–∞–∫ ‚Äú–∫—Ä–∞—Ç–Ω–æ—Å—Ç—å/—É–ø–∞–∫–æ–≤–∫–∞‚Äù
- –µ—Å–ª–∏ –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞ (>=80) —Ä—è–¥–æ–º —Å ‚Äú—à—Ç‚Äù ‚Üí –≤–µ—Ä–æ—è—Ç–Ω–æ tier, –Ω–µ pack_qty (warn)

### 4.5 Regex: –ø–æ–¥—Ç–∏–ø/–∫–∞—á–µ—Å—Ç–≤–æ/—Ñ–æ—Ä–º–∞ (subtype/grade)
–ö–ª—é—á–µ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã:
- `—Å–ø—Ä–µ–π|spray` ‚Üí subtype=spray
- `–∫—É—Å—Ç–æ–≤–∞—è` ‚Üí subtype=bush
- `—Å—Ç–∞–Ω–¥–∞—Ä—Ç|standard` ‚Üí grade=standard
- `–ø—Ä–µ–º–∏—É–º|premium` ‚Üí grade=premium
- `–º–∏–∫—Å|mix` ‚Üí subtype=mix (—Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏, —á–∞—Å—Ç–æ —ç—Ç–æ –Ω–µ SKU)

---

## 5) –ê–ª–≥–æ—Ä–∏—Ç–º propose (–∞–≤—Ç–æ–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞)

–í—Ö–æ–¥: `supplier_item` (raw_name, raw_group, name_norm, attributes)  
–í—ã—Ö–æ–¥: –∑–∞–ø–∏—Å–∏ `sku_mappings` —Å–æ status=proposed –∏ confidence.

### 5.1 –®–∞–≥–∏ propose
1) **Context merge**
- –±–µ—Ä—ë–º `raw_group` (–∫–∞—Ç–µ–≥–æ—Ä–∏—è/—Å—Ç—Ä–∞–Ω–∞/—Ä–∞–∑–¥–µ–ª) –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–æ–∫–µ–Ω–æ–≤
- –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Å `raw_name`

2) **Extract attributes**
- –ø—Ä–∏–º–µ–Ω—è–µ–º regex_rule: –¥–ª–∏–Ω–∞/—Å—Ç—Ä–∞–Ω–∞/—É–ø–∞–∫–æ–≤–∫–∞/–ø–æ–¥—Ç–∏–ø/grade/–±—Ä–µ–Ω–¥
- —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `supplier_items.attributes`

3) **Detect product_type**
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- –∏–∑ raw_group (–µ—Å–ª–∏ –æ–Ω ‚Äú–†–æ–∑—ã/–ì–≤–æ–∑–¥–∏–∫–∞/–ó–µ–ª–µ–Ω—å/‚Ä¶‚Äù)
- –∏–Ω–∞—á–µ –ø–æ —Å–ª–æ–≤–∞—Ä—é `product_type` (–ø–æ —Ç–æ–∫–µ–Ω–∞–º)

4) **Detect variety**
- –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –ª–∞—Ç–∏–Ω—Å–∫–∏–µ —Ç–æ–∫–µ–Ω—ã (Explorer, Mondial, Pink Floyd‚Ä¶), –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—É—é variety
- –∑–∞—Ç–µ–º –ø—Ä–æ–≥–æ–Ω—è–µ–º —á–µ—Ä–µ–∑ `variety_alias` (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –µ—Å–ª–∏ variety –Ω–µ —É–≤–µ—Ä–µ–Ω–∞ ‚Üí –æ—Å—Ç–∞–≤–ª—è–µ–º NULL –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ manual-review (–µ—Å–ª–∏ product_type —Ç–æ–∂–µ –Ω–µ —É–≤–µ—Ä–µ–Ω)

5) **Candidate search –≤ normalized_skus**
–ú–µ—Ç–æ–¥—ã (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):
- Exact match: (product_type + variety) —Å–æ–≤–ø–∞–ª–∏ –ø–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –≤–∏–¥—É
- High similarity (trgm): —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å title/variety
- Token overlap: –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (–±–µ–∑ —Å—Ç–æ–ø-—Å–ª–æ–≤)

6) **Create/Update sku_mappings**
- —Å–æ–∑–¥–∞—ë–º 1..N –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (N<=5) –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
- –ª—É—á—à–∏–π –∫–∞–Ω–¥–∏–¥–∞—Ç –∏–¥—ë—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º confidence

---

## 6) Confidence scoring (–ø—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å MVP)

–¶–µ–ª—å: —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ—à–∞—Ç—å, —á—Ç–æ —É—Ö–æ–¥–∏—Ç –≤ —Ä—É—á–Ω–æ–π —Ä–∞–∑–±–æ—Ä.

### 6.1 –ë–∞–∑–æ–≤—ã–π —Å–∫–æ—Ä
`score = 0.10`

### 6.2 –ü—Ä–∏–±–∞–≤–∫–∏
- product_type —Å–æ–≤–ø–∞–ª (–ø–æ —Å–ª–æ–≤–∞—Ä—é) ‚Üí `+0.30`
- variety exact (–ø–æ—Å–ª–µ alias) ‚Üí `+0.45`
- variety high similarity (trgm >= 0.70) ‚Üí `+0.30`
- subtype —Å–æ–≤–ø–∞–ª (spray/bush/standard/premium) ‚Üí `+0.05`
- country —Å–æ–≤–ø–∞–ª (–µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞–µ–º) ‚Üí `+0.05`
- –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —É–∂–µ –±—ã–ª confirmed mapping –¥–ª—è –ø–æ—Ö–æ–∂–µ–≥–æ stable_key (–µ—Å–ª–∏ –µ—Å—Ç—å) ‚Üí `+0.15`

### 6.3 –®—Ç—Ä–∞—Ñ—ã
- variety —Å–æ–¥–µ—Ä–∂–∏—Ç ‚Äú–º–∏–∫—Å/mix‚Äù ‚Üí `-0.25`
- name —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ / –º–∞–ª–æ —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí `-0.10`
- –∫–æ–Ω—Ñ–ª–∏–∫—Ç: –ø—Ä–æ–¥—É–∫—Ç-—Ç–∏–ø —Ä–æ–∑–∞, –Ω–æ —Ç–æ–∫–µ–Ω—ã –≥–≤–æ–∑–¥–∏–∫–∞ ‚Üí `-0.20`

### 6.4 –ü–æ—Ä–æ–≥–∏
- `score >= 0.90` ‚Üí –º–æ–∂–Ω–æ **auto-confirm (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ñ–ª–∞–≥–æ–º)**  
  (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å—ë —Ä–∞–≤–Ω–æ proposed, –Ω–æ —Å—Ç–∞–≤–∏–º high_priority_review=false)
- `0.70 <= score < 0.90` ‚Üí proposed ‚Üí –æ–±—ã—á–Ω—ã–π review
- `score < 0.70` ‚Üí —Å–æ–∑–¥–∞—ë–º `normalization_task` (manual –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

---

## 7) Manual-review (–æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á)

### 7.1 –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë–º normalization_task
- product_type –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω
- variety –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
- score < 0.70
- –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å –±–ª–∏–∑–∫–∏–º–∏ score (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω–∏—Ü–∞ < 0.05)
- supplier_item –ø–æ–º–µ—á–µ–Ω ambiguous

### 7.2 –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (priority)
MVP-–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å—á–∏—Ç–∞–µ–º —Ç–∞–∫:
- base = 100
- + (–∫–æ–ª-–≤–æ offer_candidates –ø–æ supplier_item) * 2
- + 50 –µ—Å–ª–∏ supplier –≤–∞–∂–Ω—ã–π (—Ä—É—á–Ω–∞—è –º–µ—Ç–∫–∞ –≤ suppliers.meta: `tier=key`)
- + 20 –µ—Å–ª–∏ item –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∞–π—Å–∞—Ö (stable_key –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è)
- - 30 –µ—Å–ª–∏ —ç—Ç–æ ‚Äú—Å–ª—É–∂–µ–±–Ω–æ–µ/–º—É—Å–æ—Ä‚Äù (stopwords/–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)

### 7.3 –≠–∫—Ä–∞–Ω –∞–¥–º–∏–Ω–∫–∏ ‚Äú–†–∞–∑–±–æ—Ä‚Äù
–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º:
- raw_name, raw_group
- –ø—Ä–∏–º–µ—Ä—ã raw_rows (row_ref + raw_text)
- extracted attributes
- top-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö normalized_sku (title + score)
- –∫–Ω–æ–ø–∫–∏:
  - Confirm –≤—ã–±—Ä–∞–Ω–Ω—ã–π
  - Create new SKU
  - Edit dictionary (–≤ –º–æ–¥–∞–ª—å–Ω–æ–º)
  - Reject item (–µ—Å–ª–∏ –º—É—Å–æ—Ä)

### 7.4 –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏
- sku_mappings.status ‚Üí confirmed
- sku_mappings.decided_at/by —Ñ–∏–∫—Å–∏—Ä—É–µ–º
- –∑–∞–ø—É—Å–∫–∞–µ–º republish –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ supplier (—Å–º. pipeline publish)

---

## 8) –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö SKU (Create SKU)

–ü—Ä–∞–≤–∏–ª–æ MVP:  
–ï—Å–ª–∏ variety —É–Ω–∏–∫–∞–ª—å–Ω–∞ –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ª—É—á—à–µ —Å–æ–∑–¥–∞—Ç—å SKU.

### 8.1 –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å SKU
- –ï—Å—Ç—å product_type + variety (–∏–ª–∏ subtype), –Ω–æ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- –≠—Ç–æ –Ω–µ ‚Äú–º–∏–∫—Å‚Äù
- –≠—Ç–æ –Ω–µ ‚Äú—Ä–∞–∑–æ–≤–æ–µ —Å–ª—É–∂–µ–±–Ω–æ–µ‚Äù

### 8.2 –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å title
- `Rose Explorer`
- `Carnation Standard`
- `Alstroemeria Garda`
- `Greens Eucalyptus` (–µ—Å–ª–∏ –µ—Å—Ç—å)

meta –º–æ–∂–Ω–æ –Ω–∞–ø–æ–ª–Ω–∏—Ç—å:
- subtype/grade
- origin_default (–µ—Å–ª–∏ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ä—ã–Ω–∫—É)

---

## 9) –ü—Ä–∏–º–µ—Ä—ã (–∏–∑ —Ç–∏–ø–æ–≤—ã—Ö –ø—Ä–∞–π—Å–æ–≤)

### –ü—Ä–∏–º–µ—Ä 1
`"–†–æ–∑–∞ Explorer 60—Å–º (–≠–∫–≤–∞–¥–æ—Ä)"`
- product_type=rose
- variety=Explorer
- origin=Ecuador (–≤ attributes)
- length_cm=60 (–≤ offer)
‚Üí mapping: Rose Explorer

### –ü—Ä–∏–º–µ—Ä 2 (–º–∞—Ç—Ä–∏—Ü–∞)
—Å—Ç—Ä–æ–∫–∞: `"–†–æ–∑–∞ —Å–ø—Ä–µ–π: Bombastic, ..."`
–∫–æ–ª–æ–Ω–∫–∏: `50 —Å–º –±–∞–∫`, `50 —Å–º —É–ø–∞–∫`, `60 —Å–º –±–∞–∫`...
- supplier_item = ‚Äú–†–æ–∑–∞ —Å–ø—Ä–µ–π Bombastic ‚Ä¶‚Äù (SAFE MODE: –ø–æ–∫–∞ bundle)
- offer_candidates = N —Å—Ç—Ä–æ–∫ –ø–æ (length_cm, pack_type)
‚Üí manual-review: –ª–∏–±–æ —Ä–∞–∑–Ω–µ—Å—Ç–∏ –Ω–∞ —Å–æ—Ä—Ç–∞, –ª–∏–±–æ —Å–æ–∑–¥–∞—Ç—å bundle SKU ‚ÄúSpray Roses Mix‚Äù (–µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω–æ —Ç–∞–∫ –ø—Ä–æ–¥–∞—ë—Ç—Å—è)

### –ü—Ä–∏–º–µ—Ä 3 (—Ç–∏—Ä—ã)
`"–†–æ–∑–∞ ..."` + —Ü–µ–Ω—ã –ø–æ ‚Äú–æ—Ç 100 –¥–æ 200‚Äù
- offer_candidates: –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å tier_min_qty/max_qty
- SKU –º–∞–ø–ø–∏—Ç—Å—è 1 —Ä–∞–∑, –æ—Ñ—Ñ–µ—Ä—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –ø–∞—á–∫–æ–π

---

## 10) –ü–µ—Ä–µ–ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏ ‚Äú—ç—Ñ—Ñ–µ–∫—Ç —Å–ª–æ–≤–∞—Ä—è‚Äù

–ö–æ–≥–¥–∞:
- –æ–±–Ω–æ–≤–∏–ª–∏ dictionary_entries
- –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ sku_mappings
- –ø–æ–ø—Ä–∞–≤–∏–ª–∏ supplier_item.attributes

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ:
- –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å propose –¥–ª—è open tasks
- –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å offers (publish stage) –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ raw import

---

## 11) –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å–ª–æ–≤–∞—Ä–µ–π –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ (bootstrap checklist)

1) product_type: —Ä–æ–∑–∞, –≥–≤–æ–∑–¥–∏–∫–∞, –∞–ª—å—Å—Ç—Ä–æ–º–µ—Ä–∏—è, —Ö—Ä–∏–∑–∞–Ω—Ç–µ–º–∞, –∑–µ–ª–µ–Ω—å, —É–ø–∞–∫–æ–≤–∫–∞
2) country: –≠–∫–≤–∞–¥–æ—Ä, –ö–æ–ª—É–º–±–∏—è, –ì–æ–ª–ª–∞–Ω–¥–∏—è/–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã, –ö–µ–Ω–∏—è, –ò–∑—Ä–∞–∏–ª—å
3) pack_type: –±–∞–∫, —É–ø–∞–∫
4) stopwords: –∏–º–ø–æ—Ä—Ç, —Å–æ—Ä—Ç–æ–≤—ã–µ, —Ä—É–±/—Ä/‚ÇΩ, —Å–º/cm, —Ü–µ–Ω–∞, –ø—Ä–∞–π—Å, –ª–∏—Å—Ç
5) regex_rule: –¥–ª–∏–Ω–∞, —Å—Ç—Ä–∞–Ω–∞, pack_qty, subtype/grade